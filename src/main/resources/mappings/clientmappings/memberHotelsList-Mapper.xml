<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="client.hotels.dao.MemberHotelsListDAO">
 
  	<select id="countHotelsList" resultType="int" parameterType="java.util.HashMap">
  		SELECT COUNT(*) FROM hotels WHERE HOTELS_TYPE = #{type}
  		AND HOTELS_ADDRESS1 LIKE '%'||#{sido}||'%' AND  
  		<foreach collection="regionList" item="item" separator="or" open="(" close=")" index="index">
  			HOTELS_ADDRESS1 LIKE '%'||#{item}||'%'
  		</foreach>
   	</select>	
   	
  	<!-- 지역으로 숙소 리스트 가져오기 -->
  	<select id="selectHotelsList" resultType="memberHotels">
  		SELECT * FROM hotels WHERE HOTELS_TYPE = #{type} AND HOTELS_ADDRESS1 LIKE '%'||#{sido}||'%' AND   
  		<foreach collection="regionList" item="item" separator="or" open="(" close=")" index="index">
  			HOTELS_ADDRESS1 LIKE '%'||#{item}||'%'
  		</foreach>
  		 ORDER BY HOTELS_CODE DESC
  	</select>
  	
  	<!-- ID로 숙소 리스트 가져오기 -->
  	<select id="selectHotelsListById" resultType="memberHotels">
  		SELECT * FROM hotels WHERE member_id = #{memberId}
  	</select>
  	
  	<!-- 인기 숙소 리스트 10개 가져오기 -->
  	<select id="selectAccommodationTop10" resultType="memberHotels">
  		<![CDATA[
  		select h.* from hotels h, ranking r where h.hotels_code = r.hotels_code and rownum <= 10
		]]>
  	</select>
  	
  	<!-- 인기 숙소(타입별) 리스트 10개 가져오기 -->
  	<select id="selectAccommodationTop10ByType" resultType="memberHotels" parameterType="memberHotels">
  		<![CDATA[
  		select h.* from hotels h, ranking r where h.hotels_code = r.hotels_code and rownum <= 10 
  		and r.hotels_type = #{hotelsType}
		]]>
  	</select>
  
  	<!-- 통합 검색 결과로 호텔 리스트 가져오기 -->
  	<select id="getSearchedHotelsList" resultType="memberHotels">
  		select * from hotels
  		where 1=1
  		<if test = "searchCondition=='ADDRESS'">
  			and hotels_address1 Like '%'||#{searchKeyword}||'%'
  		</if>
  		<if test = "searchCondition=='NAME'">
  			and hotels_name Like '%'||#{searchKeyword}||'%'
  		</if>
  		<if test = "searchCondition=='PATH'">
  			and hotels_path Like '%'||#{searchKeyword}||'%'
  		</if>
  	</select>
 </mapper>